{"ast":null,"code":"var _jsxFileName = \"/Users/jutawuth/Git/SSQUARE/Component-AS400-React/src/pages/ScreenMapping/index.jsx\";\nimport React, { Component, useRef } from \"react\";\nimport Axios from \"axios\";\nimport ScreenMapping from \"../../components/ScreenMapping\";\nimport { setAs400Screen, setAs400Style, getAS400Cursor, setAS400Cursor, getIndexByRowCol, setSelectionRange, getStartSelection } from \"../../components/Emulator/controler\";\nconst data = {\n  HEADER: {\n    tokenId: \"EWI112233445566\",\n    requestId: \"ABC123456789\",\n    deviceId: \"UUID9988776655\"\n  },\n  DATA: {\n    screen: {\n      rows: 24,\n      cols: 80\n    },\n    Text: \"                                   Sign On                                      \\n                                               System  . . . . . :   S101CD3M   \\n                                               Subsystem . . . . :   QINTER     \\n                                               Display . . . . . :   QPADEV003R \\n                                                                                \\n                User  . . . . . . . . . . . . . .                               \\n                Password  . . . . . . . . . . . .                               \\n                Program/procedure . . . . . . . .                               \\n                Menu  . . . . . . . . . . . . . .                               \\n                Current library . . . . . . . . .                               \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                        (C) COPYRIGHT IBM CORP. 1980, 2005.     \",\n    Style: \".................................RRRRRRRRRRRRR..................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n.........................................................UUUUUUUUUU.............\\n.........................................................HHHHHHHHHH.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\",\n    Cursor: \"5,53\"\n  }\n};\nconst id = \"flow\";\nconst _data$DATA$screen = data.DATA.screen,\n      rows = _data$DATA$screen.rows,\n      cols = _data$DATA$screen.cols;\nconst _data$DATA = data.DATA,\n      text = _data$DATA.Text,\n      style = _data$DATA.Style,\n      cursor = _data$DATA.Cursor;\nconst highlightList = {\n  mark1: {\n    text: \"Sign On\",\n    row: 1,\n    col: 36\n  },\n  mark2: {\n    text: \"User\",\n    row: 6,\n    col: 17\n  },\n  mark3: {\n    text: \"(C) COPYRIGHT IBM CORP. 1980, 2005.\",\n    row: 24,\n    col: 41\n  }\n};\nconst smRef = useRef();\nconst MARK1 = \"mark-1\";\n\nconst onDbllickHandler = event => {\n  // console.log(`| ========== ${event.type} ========== |`);\n  let eventKey = event.key;\n\n  if (event.keyCode >= 8 && event.keyCode < 48) {\n    eventKey = `[' + ${eventKey.toLowerCase()} + ']`;\n  }\n\n  const selected = getStartSelection(id, cols);\n  const dataForApi = {\n    HEADER: {\n      tokenId: \"EWI112233445566\",\n      requestId: \"ABC123456789\",\n      deviceId: \"UUID9988776655\" // requestCount: this.resultCount\n\n    },\n    DATA: {\n      Event: \"SELECTION\",\n      KeyValue: eventKey,\n      Cursor: `${selected.row},${selected.col}`\n    }\n  };\n  Axios({\n    method: \"post\",\n    url: \"http://localhost:8085/emulator\",\n    data: JSON.stringify(dataForApi),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(response => {\n    // handle success\n    const data = response.data.DATA;\n    setAs400Screen(id, data.Text);\n    setAs400Style(id, data.Text, data.Style);\n    setAS400Cursor(id, data.Cursor);\n    const fields = data.Fields;\n    let selection = null;\n    const index = getAS400Cursor(data.Cursor);\n    fields.forEach(f => {\n      if (Math.abs(f.EndRow - f.StartRow) === 0) {\n        if (index.col >= f.StartCol && index.col <= f.EndCol && f.StartRow === index.row) {\n          selection = f;\n        }\n      }\n    });\n    const selectionStart = getIndexByRowCol(selection.StartRow, selection.StartCol);\n    const selectionEnd = getIndexByRowCol(selection.EndRow, selection.EndCol);\n    setSelectionRange(id, selectionStart, selectionEnd);\n  }).catch(response => {\n    // handle error\n    console.log(`response: ${response}`);\n  });\n};\n\nconst onMouseUpHandler = event => {\n  // console.log(`| ========== ${event.type} ========== | `);\n  if (event.keyCode === 9 || event.keyCode > 111 && event.keyCode !== 123) {\n    event.preventDefault();\n  }\n\n  let eventKey = event.key;\n  const selected = getStartSelection(id, cols);\n\n  if (event.keyCode >= 8 && event.keyCode < 48) {\n    eventKey = `[' + ${eventKey.toLowerCase()} + ']`;\n  }\n\n  const dataForApi = {\n    HEADER: {\n      tokenId: \"EWI112233445566\",\n      requestId: \"ABC123456789\",\n      deviceId: \"UUID9988776655\" // requestCount: this.resultCount\n\n    },\n    DATA: {\n      Event: \"KEYDOWN\",\n      KeyValue: eventKey,\n      Cursor: `${selected.row},${selected.col}`\n    }\n  };\n  Axios({\n    method: \"post\",\n    url: \"http://localhost:8085/emulator\",\n    data: JSON.stringify(dataForApi),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(response => {\n    // handle success\n    const data = response.data.DATA;\n    setAs400Screen(id, data.Text);\n    setAs400Style(id, data.Text, data.Style);\n    setAS400Cursor(id, data.Cursor); // this.clearAllMarkChackString(id);\n  }).catch(response => {\n    // handle error\n    console.log(`response: ${response}`);\n  });\n};\n\nclass ScreenMappingEmulator extends Component {\n  constructor(props) {\n    super(props);\n    this.myRef = React.createRef();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(ScreenMapping, {\n      id: id,\n      ref: smRef,\n      rows: rows,\n      cols: cols,\n      text: text,\n      style: style,\n      cursor: cursor,\n      highlight: highlightList,\n      onDoubleClick: onDbllickHandler,\n      onMouseUp: onMouseUpHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: () => smRef.current.setHighlightList(highlightList),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"highlight\"), React.createElement(\"button\", {\n      onClick: () => {\n        console.log(smRef.current.getHighlightList());\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, \"get mark\"), React.createElement(\"button\", {\n      onClick: () => smRef.current.clearHighlightList(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, \"clear\"), React.createElement(\"button\", {\n      onClick: () => {\n        const highlight = smRef.current.getLastSelection();\n        smRef.current.setHighlight(MARK1, highlight);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"mark 1\"), React.createElement(\"button\", {\n      onClick: () => {\n        console.log(smRef.current.getHighlight(MARK1));\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"get mark 1\"), React.createElement(\"button\", {\n      onClick: () => {\n        smRef.current.clearHighlight(MARK1);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, \"clear mark 1\"));\n  }\n\n}\n\nexport default ScreenMappingEmulator;","map":{"version":3,"sources":["/Users/jutawuth/Git/SSQUARE/Component-AS400-React/src/pages/ScreenMapping/index.jsx"],"names":["React","Component","useRef","Axios","ScreenMapping","setAs400Screen","setAs400Style","getAS400Cursor","setAS400Cursor","getIndexByRowCol","setSelectionRange","getStartSelection","data","HEADER","tokenId","requestId","deviceId","DATA","screen","rows","cols","Text","Style","Cursor","id","text","style","cursor","highlightList","mark1","row","col","mark2","mark3","smRef","MARK1","onDbllickHandler","event","eventKey","key","keyCode","toLowerCase","selected","dataForApi","Event","KeyValue","method","url","JSON","stringify","headers","then","response","fields","Fields","selection","index","forEach","f","Math","abs","EndRow","StartRow","StartCol","EndCol","selectionStart","selectionEnd","catch","console","log","onMouseUpHandler","preventDefault","ScreenMappingEmulator","constructor","props","myRef","createRef","render","current","setHighlightList","getHighlightList","clearHighlightList","highlight","getLastSelection","setHighlight","getHighlight","clearHighlight"],"mappings":"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","sourcesContent":["import React, { Component, useRef } from \"react\";\nimport Axios from \"axios\";\n\nimport ScreenMapping from \"../../components/ScreenMapping\";\n\nimport {\n  setAs400Screen,\n  setAs400Style,\n  getAS400Cursor,\n  setAS400Cursor,\n  getIndexByRowCol,\n  setSelectionRange,\n  getStartSelection\n} from \"../../components/Emulator/controler\";\n\nconst data = {\n  HEADER: {\n    tokenId: \"EWI112233445566\",\n    requestId: \"ABC123456789\",\n    deviceId: \"UUID9988776655\"\n  },\n  DATA: {\n    screen: { rows: 24, cols: 80 },\n    Text:\n      \"                                   Sign On                                      \\n                                               System  . . . . . :   S101CD3M   \\n                                               Subsystem . . . . :   QINTER     \\n                                               Display . . . . . :   QPADEV003R \\n                                                                                \\n                User  . . . . . . . . . . . . . .                               \\n                Password  . . . . . . . . . . . .                               \\n                Program/procedure . . . . . . . .                               \\n                Menu  . . . . . . . . . . . . . .                               \\n                Current library . . . . . . . . .                               \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                        (C) COPYRIGHT IBM CORP. 1980, 2005.     \",\n    Style:\n      \".................................RRRRRRRRRRRRR..................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n.........................................................UUUUUUUUUU.............\\n.........................................................HHHHHHHHHH.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\",\n    Cursor: \"5,53\"\n  }\n};\n\nconst id = \"flow\";\nconst { rows, cols } = data.DATA.screen;\nconst { Text: text, Style: style, Cursor: cursor } = data.DATA;\nconst highlightList = {\n  mark1: {\n    text: \"Sign On\",\n    row: 1,\n    col: 36\n  },\n  mark2: {\n    text: \"User\",\n    row: 6,\n    col: 17\n  },\n  mark3: {\n    text: \"(C) COPYRIGHT IBM CORP. 1980, 2005.\",\n    row: 24,\n    col: 41\n  }\n};\n\nconst smRef = useRef();\nconst MARK1 = \"mark-1\";\n\nconst onDbllickHandler = event => {\n  // console.log(`| ========== ${event.type} ========== |`);\n  let eventKey = event.key;\n  if (event.keyCode >= 8 && event.keyCode < 48) {\n    eventKey = `[' + ${eventKey.toLowerCase()} + ']`;\n  }\n  const selected = getStartSelection(id, cols);\n  const dataForApi = {\n    HEADER: {\n      tokenId: \"EWI112233445566\",\n      requestId: \"ABC123456789\",\n      deviceId: \"UUID9988776655\"\n      // requestCount: this.resultCount\n    },\n    DATA: {\n      Event: \"SELECTION\",\n      KeyValue: eventKey,\n      Cursor: `${selected.row},${selected.col}`\n    }\n  };\n\n  Axios({\n    method: \"post\",\n    url: \"http://localhost:8085/emulator\",\n    data: JSON.stringify(dataForApi),\n    headers: { \"Content-Type\": \"application/json\" }\n  })\n    .then(response => {\n      // handle success\n      const data = response.data.DATA;\n\n      setAs400Screen(id, data.Text);\n      setAs400Style(id, data.Text, data.Style);\n      setAS400Cursor(id, data.Cursor);\n\n      const fields = data.Fields;\n      let selection = null;\n\n      const index = getAS400Cursor(data.Cursor);\n      fields.forEach(f => {\n        if (Math.abs(f.EndRow - f.StartRow) === 0) {\n          if (\n            index.col >= f.StartCol &&\n            index.col <= f.EndCol &&\n            f.StartRow === index.row\n          ) {\n            selection = f;\n          }\n        }\n      });\n\n      const selectionStart = getIndexByRowCol(\n        selection.StartRow,\n        selection.StartCol\n      );\n      const selectionEnd = getIndexByRowCol(selection.EndRow, selection.EndCol);\n\n      setSelectionRange(id, selectionStart, selectionEnd);\n    })\n    .catch(response => {\n      // handle error\n      console.log(`response: ${response}`);\n    });\n};\n\nconst onMouseUpHandler = event => {\n  // console.log(`| ========== ${event.type} ========== | `);\n  if (event.keyCode === 9 || (event.keyCode > 111 && event.keyCode !== 123)) {\n    event.preventDefault();\n  }\n\n  let eventKey = event.key;\n  const selected = getStartSelection(id, cols);\n  if (event.keyCode >= 8 && event.keyCode < 48) {\n    eventKey = `[' + ${eventKey.toLowerCase()} + ']`;\n  }\n  const dataForApi = {\n    HEADER: {\n      tokenId: \"EWI112233445566\",\n      requestId: \"ABC123456789\",\n      deviceId: \"UUID9988776655\"\n      // requestCount: this.resultCount\n    },\n    DATA: {\n      Event: \"KEYDOWN\",\n      KeyValue: eventKey,\n      Cursor: `${selected.row},${selected.col}`\n    }\n  };\n\n  Axios({\n    method: \"post\",\n    url: \"http://localhost:8085/emulator\",\n    data: JSON.stringify(dataForApi),\n    headers: { \"Content-Type\": \"application/json\" }\n  })\n    .then(response => {\n      // handle success\n      const data = response.data.DATA;\n\n      setAs400Screen(id, data.Text);\n      setAs400Style(id, data.Text, data.Style);\n      setAS400Cursor(id, data.Cursor);\n\n      // this.clearAllMarkChackString(id);\n    })\n    .catch(response => {\n      // handle error\n      console.log(`response: ${response}`);\n    });\n};\n\nclass ScreenMappingEmulator extends Component {\n  constructor(props) {\n    super(props);\n\n    this.myRef = React.createRef();\n  }\n\n  render() {\n    return (\n      <div>\n        <ScreenMapping\n          id={id}\n          ref={smRef}\n          rows={rows}\n          cols={cols}\n          text={text}\n          style={style}\n          cursor={cursor}\n          highlight={highlightList}\n          onDoubleClick={onDbllickHandler}\n          onMouseUp={onMouseUpHandler}\n        />\n        <button onClick={() => smRef.current.setHighlightList(highlightList)}>\n          highlight\n        </button>\n        <button\n          onClick={() => {\n            console.log(smRef.current.getHighlightList());\n          }}\n        >\n          get mark\n        </button>\n        <button onClick={() => smRef.current.clearHighlightList()}>\n          clear\n        </button>\n        <button\n          onClick={() => {\n            const highlight = smRef.current.getLastSelection();\n            smRef.current.setHighlight(MARK1, highlight);\n          }}\n        >\n          mark 1\n        </button>\n        <button\n          onClick={() => {\n            console.log(smRef.current.getHighlight(MARK1));\n          }}\n        >\n          get mark 1\n        </button>\n        <button\n          onClick={() => {\n            smRef.current.clearHighlight(MARK1);\n          }}\n        >\n          clear mark 1\n        </button>\n      </div>\n    );\n  }\n}\nexport default ScreenMappingEmulator;\n"]},"metadata":{},"sourceType":"module"}