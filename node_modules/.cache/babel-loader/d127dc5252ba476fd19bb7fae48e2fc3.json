{"ast":null,"code":"import _classCallCheck from\"/Users/jutawuth/Git/react/AS400Emulator/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jutawuth/Git/react/AS400Emulator/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jutawuth/Git/react/AS400Emulator/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jutawuth/Git/react/AS400Emulator/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jutawuth/Git/react/AS400Emulator/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import Axios from\"axios\";import ScreenMapping from\"../../components/ScreenMapping\";import{setAs400Screen,setAs400Style,getAS400Cursor,setAS400Cursor,getIndexByRowCol,setSelectionRange,getStartSelection}from\"../../components/Emulator/controler\";var data={HEADER:{tokenId:\"EWI112233445566\",requestId:\"ABC123456789\",deviceId:\"UUID9988776655\"},DATA:{screen:{rows:24,cols:80},Text:\"                                   Sign On                                      \\n                                               System  . . . . . :   S101CD3M   \\n                                               Subsystem . . . . :   QINTER     \\n                                               Display . . . . . :   QPADEV003R \\n                                                                                \\n                User  . . . . . . . . . . . . . .                               \\n                Password  . . . . . . . . . . . .                               \\n                Program/procedure . . . . . . . .                               \\n                Menu  . . . . . . . . . . . . . .                               \\n                Current library . . . . . . . . .                               \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                        (C) COPYRIGHT IBM CORP. 1980, 2005.     \",Style:\".................................RRRRRRRRRRRRR..................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n.........................................................UUUUUUUUUU.............\\n.........................................................HHHHHHHHHH.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\",Cursor:\"5,53\"}};var id=\"flow2\";var _data$DATA$screen=data.DATA.screen,rows=_data$DATA$screen.rows,cols=_data$DATA$screen.cols;var _data$DATA=data.DATA,text=_data$DATA.Text,style=_data$DATA.Style,cursor=_data$DATA.Cursor;var highlightList={mark1:{text:\"Sign On\",row:1,col:36},mark2:{text:\"User\",row:6,col:17},mark3:{text:\"(C) COPYRIGHT IBM CORP. 1980, 2005.\",row:24,col:41}};var MARK1=\"mark-1\";var MARK2=\"mark-2\";var MARK3=\"mark-3\";var onDblClickHandler=function onDblClickHandler(event){// console.log(`| ========== ${event.type} ========== |`);\nvar eventKey=event.key;if(event.keyCode>=8&&event.keyCode<48){eventKey=\"[' + \".concat(eventKey.toLowerCase(),\" + ']\");}var selected=getStartSelection(id,cols);var dataForApi={HEADER:{tokenId:\"EWI112233445566\",requestId:\"ABC123456789\",deviceId:\"UUID9988776655\"// requestCount: this.resultCount\n},DATA:{Event:\"SELECTION\",KeyValue:eventKey,Cursor:\"\".concat(selected.row,\",\").concat(selected.col)}};Axios({method:\"post\",url:\"http://localhost:8085/emulator\",data:JSON.stringify(dataForApi),headers:{\"Content-Type\":\"application/json\"}}).then(function(response){// handle success\nvar data=response.data.DATA;setAs400Screen(id,data.Text);setAs400Style(id,data.Text,data.Style);setAS400Cursor(id,data.Cursor);var fields=data.Fields;var selection=null;var index=getAS400Cursor(data.Cursor);fields.forEach(function(f){if(Math.abs(f.EndRow-f.StartRow)===0){if(index.col>=f.StartCol&&index.col<=f.EndCol&&f.StartRow===index.row){selection=f;}}});var selectionStart=getIndexByRowCol(selection.StartRow,selection.StartCol);var selectionEnd=getIndexByRowCol(selection.EndRow,selection.EndCol);setSelectionRange(id,selectionStart,selectionEnd);}).catch(function(response){// handle error\nconsole.log(\"response: \".concat(response));});};var onMouseUpHandler=function onMouseUpHandler(event){// console.log(`| ========== ${event.type} ========== | `);\nif(event.keyCode===9||event.keyCode>111&&event.keyCode!==123){event.preventDefault();}var eventKey=event.key;var selected=getStartSelection(id,cols);if(event.keyCode>=8&&event.keyCode<48){eventKey=\"[' + \".concat(eventKey.toLowerCase(),\" + ']\");}var dataForApi={HEADER:{tokenId:\"EWI112233445566\",requestId:\"ABC123456789\",deviceId:\"UUID9988776655\"// requestCount: this.resultCount\n},DATA:{Event:\"KEYDOWN\",KeyValue:eventKey,Cursor:\"\".concat(selected.row,\",\").concat(selected.col)}};Axios({method:\"post\",url:\"http://localhost:8085/emulator\",data:JSON.stringify(dataForApi),headers:{\"Content-Type\":\"application/json\"}}).then(function(response){// handle success\nvar data=response.data.DATA;setAs400Screen(id,data.Text);setAs400Style(id,data.Text,data.Style);setAS400Cursor(id,data.Cursor);// this.clearAllMarkChackString(id);\n}).catch(function(response){// handle error\nconsole.log(\"response: \".concat(response));});};var ScreenMappingPage=/*#__PURE__*/function(_Component){_inherits(ScreenMappingPage,_Component);function ScreenMappingPage(props){var _this;_classCallCheck(this,ScreenMappingPage);_this=_possibleConstructorReturn(this,_getPrototypeOf(ScreenMappingPage).call(this,props));_this.smRef=React.createRef();return _this;}_createClass(ScreenMappingPage,[{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"div\",null,React.createElement(ScreenMapping,{id:id,ref:this.smRef,rows:rows,cols:cols,text:text,style:style,cursor:cursor,highlight:highlightList,onDoubleClick:onDblClickHandler,onMouseUp:onMouseUpHandler}),React.createElement(\"button\",{onClick:function onClick(){return _this2.smRef.current.setHighlightList(highlightList);}},\"highlight list\"),React.createElement(\"button\",{onClick:function onClick(){console.log(_this2.smRef.current.getHighlightList());}},\"get mark list\"),React.createElement(\"button\",{onClick:function onClick(){return _this2.smRef.current.clearHighlightList();}},\"clear mark list\"),React.createElement(\"br\",null),React.createElement(\"button\",{onClick:function onClick(){var highlight=_this2.smRef.current.getLastSelection();_this2.smRef.current.setHighlight(MARK1,highlight);}},\"mark 1\"),React.createElement(\"button\",{onClick:function onClick(){console.log(_this2.smRef.current.getHighlight(MARK1));}},\"get mark 1\"),React.createElement(\"button\",{onClick:function onClick(){_this2.smRef.current.clearHighlight(MARK1);}},\"clear mark 1\"),React.createElement(\"br\",null),React.createElement(\"button\",{onClick:function onClick(){var highlight=_this2.smRef.current.getLastSelection();_this2.smRef.current.setHighlight(MARK2,highlight);}},\"mark 2\"),React.createElement(\"button\",{onClick:function onClick(){console.log(_this2.smRef.current.getHighlight(MARK2));}},\"get mark 2\"),React.createElement(\"button\",{onClick:function onClick(){_this2.smRef.current.clearHighlight(MARK2);}},\"clear mark 2\"),React.createElement(\"br\",null),React.createElement(\"button\",{onClick:function onClick(){var highlight=_this2.smRef.current.getLastSelection();_this2.smRef.current.setHighlight(MARK3,highlight);}},\"mark 3\"),React.createElement(\"button\",{onClick:function onClick(){console.log(_this2.smRef.current.getHighlight(MARK3));}},\"get mark 3\"),React.createElement(\"button\",{onClick:function onClick(){_this2.smRef.current.clearHighlight(MARK3);}},\"clear mark 3\"));}}]);return ScreenMappingPage;}(Component);export default ScreenMappingPage;","map":{"version":3,"sources":["/Users/jutawuth/Git/react/AS400Emulator/src/pages/ScreenMapping/index.jsx"],"names":["React","Component","Axios","ScreenMapping","setAs400Screen","setAs400Style","getAS400Cursor","setAS400Cursor","getIndexByRowCol","setSelectionRange","getStartSelection","data","HEADER","tokenId","requestId","deviceId","DATA","screen","rows","cols","Text","Style","Cursor","id","text","style","cursor","highlightList","mark1","row","col","mark2","mark3","MARK1","MARK2","MARK3","onDblClickHandler","event","eventKey","key","keyCode","toLowerCase","selected","dataForApi","Event","KeyValue","method","url","JSON","stringify","headers","then","response","fields","Fields","selection","index","forEach","f","Math","abs","EndRow","StartRow","StartCol","EndCol","selectionStart","selectionEnd","catch","console","log","onMouseUpHandler","preventDefault","ScreenMappingPage","props","smRef","createRef","current","setHighlightList","getHighlightList","clearHighlightList","highlight","getLastSelection","setHighlight","getHighlight","clearHighlight"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Axios from \"axios\";\n\nimport ScreenMapping from \"../../components/ScreenMapping\";\n\nimport {\n  setAs400Screen,\n  setAs400Style,\n  getAS400Cursor,\n  setAS400Cursor,\n  getIndexByRowCol,\n  setSelectionRange,\n  getStartSelection\n} from \"../../components/Emulator/controler\";\n\nconst data = {\n  HEADER: {\n    tokenId: \"EWI112233445566\",\n    requestId: \"ABC123456789\",\n    deviceId: \"UUID9988776655\"\n  },\n  DATA: {\n    screen: { rows: 24, cols: 80 },\n    Text:\n      \"                                   Sign On                                      \\n                                               System  . . . . . :   S101CD3M   \\n                                               Subsystem . . . . :   QINTER     \\n                                               Display . . . . . :   QPADEV003R \\n                                                                                \\n                User  . . . . . . . . . . . . . .                               \\n                Password  . . . . . . . . . . . .                               \\n                Program/procedure . . . . . . . .                               \\n                Menu  . . . . . . . . . . . . . .                               \\n                Current library . . . . . . . . .                               \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                                                                \\n                                        (C) COPYRIGHT IBM CORP. 1980, 2005.     \",\n    Style:\n      \".................................RRRRRRRRRRRRR..................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n.........................................................UUUUUUUUUU.............\\n.........................................................HHHHHHHHHH.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n.........................................................UUUUUUUUUU.............\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\\n................................................................................\",\n    Cursor: \"5,53\"\n  }\n};\n\nconst id = \"flow2\";\nconst { rows, cols } = data.DATA.screen;\nconst { Text: text, Style: style, Cursor: cursor } = data.DATA;\nconst highlightList = {\n  mark1: {\n    text: \"Sign On\",\n    row: 1,\n    col: 36\n  },\n  mark2: {\n    text: \"User\",\n    row: 6,\n    col: 17\n  },\n  mark3: {\n    text: \"(C) COPYRIGHT IBM CORP. 1980, 2005.\",\n    row: 24,\n    col: 41\n  }\n};\n\nconst MARK1 = \"mark-1\";\nconst MARK2 = \"mark-2\";\nconst MARK3 = \"mark-3\";\n\nconst onDblClickHandler = event => {\n  // console.log(`| ========== ${event.type} ========== |`);\n  let eventKey = event.key;\n  if (event.keyCode >= 8 && event.keyCode < 48) {\n    eventKey = `[' + ${eventKey.toLowerCase()} + ']`;\n  }\n  const selected = getStartSelection(id, cols);\n  const dataForApi = {\n    HEADER: {\n      tokenId: \"EWI112233445566\",\n      requestId: \"ABC123456789\",\n      deviceId: \"UUID9988776655\"\n      // requestCount: this.resultCount\n    },\n    DATA: {\n      Event: \"SELECTION\",\n      KeyValue: eventKey,\n      Cursor: `${selected.row},${selected.col}`\n    }\n  };\n\n  Axios({\n    method: \"post\",\n    url: \"http://localhost:8085/emulator\",\n    data: JSON.stringify(dataForApi),\n    headers: { \"Content-Type\": \"application/json\" }\n  })\n    .then(response => {\n      // handle success\n      const data = response.data.DATA;\n\n      setAs400Screen(id, data.Text);\n      setAs400Style(id, data.Text, data.Style);\n      setAS400Cursor(id, data.Cursor);\n\n      const fields = data.Fields;\n      let selection = null;\n\n      const index = getAS400Cursor(data.Cursor);\n      fields.forEach(f => {\n        if (Math.abs(f.EndRow - f.StartRow) === 0) {\n          if (\n            index.col >= f.StartCol &&\n            index.col <= f.EndCol &&\n            f.StartRow === index.row\n          ) {\n            selection = f;\n          }\n        }\n      });\n\n      const selectionStart = getIndexByRowCol(\n        selection.StartRow,\n        selection.StartCol\n      );\n      const selectionEnd = getIndexByRowCol(selection.EndRow, selection.EndCol);\n\n      setSelectionRange(id, selectionStart, selectionEnd);\n    })\n    .catch(response => {\n      // handle error\n      console.log(`response: ${response}`);\n    });\n};\n\nconst onMouseUpHandler = event => {\n  // console.log(`| ========== ${event.type} ========== | `);\n  if (event.keyCode === 9 || (event.keyCode > 111 && event.keyCode !== 123)) {\n    event.preventDefault();\n  }\n\n  let eventKey = event.key;\n  const selected = getStartSelection(id, cols);\n  if (event.keyCode >= 8 && event.keyCode < 48) {\n    eventKey = `[' + ${eventKey.toLowerCase()} + ']`;\n  }\n  const dataForApi = {\n    HEADER: {\n      tokenId: \"EWI112233445566\",\n      requestId: \"ABC123456789\",\n      deviceId: \"UUID9988776655\"\n      // requestCount: this.resultCount\n    },\n    DATA: {\n      Event: \"KEYDOWN\",\n      KeyValue: eventKey,\n      Cursor: `${selected.row},${selected.col}`\n    }\n  };\n\n  Axios({\n    method: \"post\",\n    url: \"http://localhost:8085/emulator\",\n    data: JSON.stringify(dataForApi),\n    headers: { \"Content-Type\": \"application/json\" }\n  })\n    .then(response => {\n      // handle success\n      const data = response.data.DATA;\n\n      setAs400Screen(id, data.Text);\n      setAs400Style(id, data.Text, data.Style);\n      setAS400Cursor(id, data.Cursor);\n\n      // this.clearAllMarkChackString(id);\n    })\n    .catch(response => {\n      // handle error\n      console.log(`response: ${response}`);\n    });\n};\n\nclass ScreenMappingPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.smRef = React.createRef();\n  }\n\n  render() {\n    return (\n      <div>\n        <ScreenMapping\n          id={id}\n          ref={this.smRef}\n          rows={rows}\n          cols={cols}\n          text={text}\n          style={style}\n          cursor={cursor}\n          highlight={highlightList}\n          onDoubleClick={onDblClickHandler}\n          onMouseUp={onMouseUpHandler}\n        />\n        <button\n          onClick={() => this.smRef.current.setHighlightList(highlightList)}\n        >\n          highlight list\n        </button>\n        <button\n          onClick={() => {\n            console.log(this.smRef.current.getHighlightList());\n          }}\n        >\n          get mark list\n        </button>\n        <button onClick={() => this.smRef.current.clearHighlightList()}>\n          clear mark list\n        </button>\n        <br />\n        <button\n          onClick={() => {\n            const highlight = this.smRef.current.getLastSelection();\n            this.smRef.current.setHighlight(MARK1, highlight);\n          }}\n        >\n          mark 1\n        </button>\n        <button\n          onClick={() => {\n            console.log(this.smRef.current.getHighlight(MARK1));\n          }}\n        >\n          get mark 1\n        </button>\n        <button\n          onClick={() => {\n            this.smRef.current.clearHighlight(MARK1);\n          }}\n        >\n          clear mark 1\n        </button>\n        <br />\n        <button\n          onClick={() => {\n            const highlight = this.smRef.current.getLastSelection();\n            this.smRef.current.setHighlight(MARK2, highlight);\n          }}\n        >\n          mark 2\n        </button>\n        <button\n          onClick={() => {\n            console.log(this.smRef.current.getHighlight(MARK2));\n          }}\n        >\n          get mark 2\n        </button>\n        <button\n          onClick={() => {\n            this.smRef.current.clearHighlight(MARK2);\n          }}\n        >\n          clear mark 2\n        </button>\n        <br />\n        <button\n          onClick={() => {\n            const highlight = this.smRef.current.getLastSelection();\n            this.smRef.current.setHighlight(MARK3, highlight);\n          }}\n        >\n          mark 3\n        </button>\n        <button\n          onClick={() => {\n            console.log(this.smRef.current.getHighlight(MARK3));\n          }}\n        >\n          get mark 3\n        </button>\n        <button\n          onClick={() => {\n            this.smRef.current.clearHighlight(MARK3);\n          }}\n        >\n          clear mark 3\n        </button>\n      </div>\n    );\n  }\n}\nexport default ScreenMappingPage;\n"]},"metadata":{},"sourceType":"module"}